<?php
 declare(strict_types=1); namespace Tygh\Addons\SdLabels\Repositories; use Tygh\Addons\SdLabels\Labels\Label; use Tygh\Enum\ImagePairTypes; class LabelImgRepository { private $langCode; public function __construct(string $langCode) { $this->langCode = $langCode; } public function updateLabelImg(int $label_id, string $display_type): bool { $use_img = $this->checkImageData($label_id, $display_type); if (!$use_img) { return false; } $label_images = fn_attach_image_pairs( 'labels_main', 'label', $label_id, $this->langCode ); $filter_images = fn_attach_image_pairs( 'filter_labels_main', 'filter_label', $label_id, $this->langCode ); return !(empty($label_images) && empty($filter_images)); } private function checkImageData(int $label_id, string $display_type): bool { if ($display_type !== Label::GRAPHIC) { return false; } $main_images = fn_rebuild_files('file_labels_main_image_icon'); $main_label_pair = fn_get_image_pairs( $label_id, 'label', ImagePairTypes::MAIN, true, true, $this->langCode ); return !(empty($main_label_pair) && empty(reset($main_images))); } public function getImg(string $label_id, string $object_type): array { return fn_get_image_pairs($label_id, $object_type, ImagePairTypes::MAIN, true, true, $this->langCode); } } 